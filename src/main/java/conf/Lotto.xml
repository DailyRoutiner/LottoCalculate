<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="LOTTO">
	<resultMap type="LottoDTO" id="lottoResultMap">
		<result property="numberId" column="NUMBER_ID" />
		<result property="numeralFrequency" column="NUMERAL_FREQUENCY" />
		<result property="trun" column="TURN_FK" />
		<result property="unitId" column="UNIT_ID_FK" />
	</resultMap>
	
	<!-- LOTTO 테이블 불러오기  -->
	<select id="lottoNumList" resultMap="lottoResultMap">
		SELECT * FROM NUMERAL_STATS;
	</select>
	
	<select id="unitPriority" resultMap="lottoResultMap">
		SELECT N.UNIT_ID_FK
		FROM NUMERAL_STATS N, UNIT_STATS U
		WHERE N.UNIT_ID_FK = U.UNIT_ID AND ROWNUM >= 3
		GROUP BY N.UNIT_ID_FK
		ORDER BY N.NUMERAL_FREQUENCY ASC;
	</select>
	
	<select id="selectEndNumber" resultMap="endNumber">
		select mod(substr(num, 1, instr(num, '/', 1, 1) -1), 10) num_1, 
			mod(substr(num, instr(num, '/', 1, 1) +1, instr(num, '/', 1, 2) - instr(num, '/', 1, 1) -1), 10) num_2,
			mod(substr(num, instr(num, '/', 1, 2) +1, instr(num, '/', 1, 3) - instr(num, '/', 1, 2) -1), 10) num_3,
			mod(substr(num, instr(num, '/', 1, 3) +1, instr(num, '/', 1, 4) - instr(num, '/', 1, 3) -1), 10) num_4,
			mod(substr(num, instr(num, '/', 1, 4) +1, instr(num, '/', 1, 5) - instr(num, '/', 1, 4) -1), 10) num_5,
			mod(substr(num, instr(num, '/', 1, 5) +1), 10) num_6
		from(select winning_number num from TOTAL_RESULT);
	</select>
</mapper>
